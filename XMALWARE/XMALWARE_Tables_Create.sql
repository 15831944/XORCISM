/****** 
Copyright (C) 2014-2015 Jerome Athias
Malwares related tables for XORCISM database
This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
******/

USE [XMALWARE]
GO

/****** Object:  Table [dbo].[MALWAREACTION]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREACTION](
	[MalwareActionID] [int] IDENTITY(1,1) NOT NULL,
	[ActionID] [int] NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREAVCLASSIFICATION]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREAVCLASSIFICATION](
	[MalwareAVClassificationID] [int] IDENTITY(1,1) NOT NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREBEHAVIOR]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREBEHAVIOR](
	[MalwareBehaviorID] [int] IDENTITY(1,1) NOT NULL,
	[BehaviorID] [int] NULL,
	[ordinal_position] [int] NOT NULL,
	[status] [nvarchar](100) NULL,
	[ActionStatusID] [int] NULL,
	[duration] [nvarchar](50) NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREBUNDLE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREBUNDLE](
	[MalwareBundleID] [int] IDENTITY(1,1) NOT NULL,
	[timestamp] [datetimeoffset](7) NOT NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREBUNDLETYPE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREBUNDLETYPE](
	[MalwareBundleTypeID] [int] IDENTITY(1,1) NOT NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARECAPABILITY]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARECAPABILITY](
	[MalwareCapabilityID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareCapabilityName] [nvarchar](50) NULL,
	[MalwareCapabilityDescription] [nvarchar](max) NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[VocabularyID] [int] NULL,
	[isEncrypted] [bit] NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[EnumerationVersionID] [int] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARECONFIGURATIONPARAMETER]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARECONFIGURATIONPARAMETER](
	[MalwareConfigurationParameterID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareConfigurationParameterName] [nvarchar](50) NULL,
	[MalwareConfigurationParameterDescription] [nvarchar](max) NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[VocabularyID] [int] NULL,
	[EnumerationVersionID] [int] NULL,
	[isEncrypted] [bit] NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREDEVDEBUGFILE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREDEVDEBUGFILE](
	[MalwareDevDebugFileID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareDevEnvironmentID] [int] NULL,
	[FileID] [int] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREDEVENVIRONMENT]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREDEVENVIRONMENT](
	[MalwareDevEnvironmentID] [int] IDENTITY(1,1) NOT NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[ConfidenceLevelID] [int] NULL,
	[ConfidenceReasonID] [int] NULL,
	[CollectionMethodID] [int] NULL,
	[CollectionToolID] [int] NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREDEVTOOL]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREDEVTOOL](
	[MalwareDevToolID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareDevEnvironmentID] [int] NULL,
	[ToolID] [int] NULL,
	[MalwareDevelopmentToolName] [nvarchar](50) NULL,
	[MalwareDevelopmentToolDescription] [nvarchar](max) NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL,
	[EnumerationVersionID] [int] NULL,
	[VocabularyID] [int] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREENTITY]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREENTITY](
	[MalwareEntityID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareEntityName] [nvarchar](50) NOT NULL,
	[MalwareEntityDescription] [nvarchar](max) NULL,
	[VocabularyID] [int] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL,
	[EnumerationVersionID] [int] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREINSTANCE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREINSTANCE](
	[MalwareInstanceID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareInstanceName] [nvarchar](100) NOT NULL,
	[MalwareInstanceDescription] [nvarchar](max) NULL,
	[MalwareHashMD5] [nvarchar](50) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARELABEL]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARELABEL](
	[MalwareLabelID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareLabelGUID] [nvarchar](500) NULL,
	[TagID] [int] NULL,
	[MalwareLabelName] [nvarchar](50) NULL,
	[MalwareLabelDescription] [nvarchar](max) NULL,
	[VocabularyID] [int] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[EnumerationVersionID] [int] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWAREMECHANISM]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWAREMECHANISM](
	[MalwareMechanismID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareMechanismGUID] [nvarchar](500) NULL,
	[MechanismID] [int] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARENAME]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARENAME](
	[MalwareNameID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareName] [nvarchar](250) NOT NULL,
	[NameGivenBy] [nvarchar](500) NULL,
	[VocabularyID] [int] NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARENAMEFORMALWAREINSTANCE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARENAMEFORMALWAREINSTANCE](
	[MalwareNameID] [int] NOT NULL,
	[MalwareInstanceID] [int] NOT NULL,
	[NameGivenBy] [nvarchar](500) NULL
) ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARESUBJECTRELATIONSHIP]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARESUBJECTRELATIONSHIP](
	[MalwareSubjectRelationshipID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareSubjectRelationshipName] [nvarchar](150) NOT NULL,
	[MalwareSubjectRelationshipDescription] [nvarchar](max) NULL,
	[VocabularyID] [int] NULL,
	[isEncrypted] [bit] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[EnumerationVersionID] [int] NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARETYPE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARETYPE](
	[MalwareTypeID] [int] IDENTITY(1,1) NOT NULL,
	[MalwareTypeGUID] [nvarchar](500) NULL,
	[MalwareTypeName] [nvarchar](100) NOT NULL,
	[MalwareTypeDescription] [nvarchar](max) NULL,
	[VocabularyID] [int] NULL,
	[CreatedDate] [datetimeoffset](7) NULL,
	[timestamp] [datetimeoffset](7) NULL,
	[ValidFromDate] [datetimeoffset](7) NULL,
	[ValidUntilDate] [datetimeoffset](7) NULL,
	[isEncrypted] [bit] NULL,
	[EnumerationVersionID] [int] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

/****** Object:  Table [dbo].[MALWARETYPEFORMALWAREINSTANCE]    Script Date: 04/03/2015 19:45:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MALWARETYPEFORMALWAREINSTANCE](
	[MalwareTypeID] [int] NOT NULL,
	[MalwareInstanceID] [int] NOT NULL
) ON [PRIMARY]

GO


